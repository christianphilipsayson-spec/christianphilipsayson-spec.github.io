<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Christian Philip Sayson - Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fadeIn 0.3s ease-out; }
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .gradient-text {
            background: linear-gradient(to right, #3b82f6, #9333ea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
    <div id="app"></div>

    <script>
        // State
        let state = {
            isEditMode: false,
            showLogin: false,
            password: '',
            searchTerm: '',
            selectedCategory: 'all',
            showUploadModal: false,
            showViewerModal: false,
            currentDoc: null,
            editingDoc: null,
            formData: { title: '', category: 'achievements', description: '', content: '' },
            profile: {
                name: 'Christian Philip Sayson',
                title: 'Computer Technology Graduate',
                bio: 'Passionate about technology and innovation. Dedicated to creating impactful solutions and continuously learning new technologies.',
                email: 'christian.sayson@gmail.com',
                phone: '+63 912 345 6789',
                location: 'Consolacion, Cebu, Philippines',
            },
            documents: []
        };

        const PASSWORD = 'admin123';

        // Storage functions
        async function loadData() {
            try {
                const profileData = await window.storage.get('portfolio_profile');
                const docsData = await window.storage.get('portfolio_documents');
                
                if (profileData?.value) {
                    state.profile = JSON.parse(profileData.value);
                }
                if (docsData?.value) {
                    state.documents = JSON.parse(docsData.value);
                } else {
                    state.documents = [
                        {
                            id: 1,
                            title: "Bachelor's Degree Certificate",
                            category: 'achievements',
                            description: 'BS Computer Technology - Graduated with Honors',
                            content: "BACHELOR'S DEGREE CERTIFICATE\n\nThis certifies that\nCHRISTIAN PHILIP SAYSON\n\nHas successfully completed the degree of\nBachelor of Science in Computer Technology\n\nAwarded: May 2025\nUniversity Name\n\nGraduated with HONORS\nGPA: 3.85/4.0",
                            fileType: 'text',
                            date: new Date().toISOString()
                        },
                        {
                            id: 2,
                            title: "Professional Resume",
                            category: 'resume',
                            description: 'Current professional resume - Updated 2026',
                            content: "CHRISTIAN PHILIP SAYSON\nComputer Technology Graduate\n\nCONTACT:\nEmail: christian.sayson@gmail.com\nPhone: +63 912 345 6789\nLocation: Consolacion, Cebu, Philippines\n\nEDUCATION:\nBachelor of Science in Computer Technology\nUniversity Name (2025)\nGPA: 3.85/4.0\n\nSKILLS:\n- Programming: Python, Java, JavaScript\n- Web Development: HTML, CSS, React\n- Database Management: SQL, MongoDB\n- Problem Solving & Critical Thinking",
                            fileType: 'text',
                            date: new Date().toISOString()
                        }
                    ];
                    await window.storage.set('portfolio_documents', JSON.stringify(state.documents));
                }
            } catch (error) {
                console.log('First visit - using default data');
            }
            render();
        }

        async function saveProfile(newProfile) {
            state.profile = newProfile;
            try {
                await window.storage.set('portfolio_profile', JSON.stringify(newProfile));
            } catch (error) {
                console.error('Error saving:', error);
            }
        }

        async function saveDocuments(docs) {
            state.documents = docs;
            try {
                await window.storage.set('portfolio_documents', JSON.stringify(docs));
            } catch (error) {
                console.error('Error saving:', error);
            }
            render();
        }

        // Global functions
        window.showLogin = () => { state.showLogin = true; render(); };
        window.closeLogin = () => { state.showLogin = false; state.password = ''; render(); };
        window.exitEditMode = () => { state.isEditMode = false; render(); };
        window.updatePassword = (val) => { state.password = val; };
        window.updateSearch = (val) => { state.searchTerm = val; render(); };
        window.selectCategory = (cat) => { state.selectedCategory = cat; render(); };
        
        window.login = () => {
            if (state.password === PASSWORD) {
                state.isEditMode = true;
                state.showLogin = false;
                state.password = '';
            } else {
                alert('Incorrect password!');
            }
            render();
        };

        window.updateProfile = async (field, value) => {
            state.profile[field] = value;
            await saveProfile(state.profile);
        };

        window.updateFormData = (field, value) => {
            state.formData[field] = value;
        };

        window.handleFileChange = (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (event) => {
                state.formData.content = event.target.result;
                state.formData.fileType = file.type.includes('pdf') ? 'pdf' : 'text';
                if (!state.formData.title) state.formData.title = file.name;
            };

            if (file.type === 'application/pdf') {
                reader.readAsDataURL(file);
            } else {
                reader.readAsText(file);
            }
        };

        window.openAddModal = () => {
            state.editingDoc = null;
            state.formData = { title: '', category: 'achievements', description: '', content: '' };
            state.showUploadModal = true;
            render();
        };

        window.closeUploadModal = () => {
            state.showUploadModal = false;
            state.editingDoc = null;
            render();
        };

        window.saveDocument = async () => {
            if (!state.formData.title || !state.formData.content) {
                alert('Please fill in title and content');
                return;
            }

            const doc = {
                id: state.editingDoc?.id || Date.now(),
                ...state.formData,
                date: new Date().toISOString()
            };

            const updatedDocs = state.editingDoc
                ? state.documents.map(d => d.id === state.editingDoc.id ? doc : d)
                : [...state.documents, doc];
            
            await saveDocuments(updatedDocs);
            state.showUploadModal = false;
            state.editingDoc = null;
            state.formData = { title: '', category: 'achievements', description: '', content: '' };
            render();
        };

        window.editDoc = (id) => {
            const doc = state.documents.find(d => d.id === id);
            if (doc) {
                state.editingDoc = doc;
                state.formData = { ...doc };
                state.showUploadModal = true;
                render();
            }
        };

        window.deleteDoc = async (id) => {
            if (confirm('Delete this document?')) {
                await saveDocuments(state.documents.filter(d => d.id !== id));
            }
        };

        window.viewDoc = (id) => {
            state.currentDoc = state.documents.find(d => d.id === id);
            state.showViewerModal = true;
            render();
        };

        window.closeViewer = () => {
            state.showViewerModal = false;
            state.currentDoc = null;
            render();
        };

        function getFilteredDocs() {
            return state.documents.filter(doc => {
                const matchesSearch = doc.title.toLowerCase().includes(state.searchTerm.toLowerCase()) ||
                                     (doc.description || '').toLowerCase().includes(state.searchTerm.toLowerCase());
                const matchesCategory = state.selectedCategory === 'all' || doc.category === state.selectedCategory;
                return matchesSearch && matchesCategory;
            });
        }

        // Render
        function render() {
            const filteredDocs = getFilteredDocs();
            
            document.getElementById('app').innerHTML = `
                <!-- Header -->
                <header class="bg-white shadow-sm sticky top-0 z-40">
                    <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                        <h1 class="text-2xl font-bold gradient-text">Portfolio</h1>
                        ${!state.isEditMode ? `
                            <button onclick="showLogin()" class="px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:shadow-lg transition-all">
                                ‚úèÔ∏è Edit Mode
                            </button>
                        ` : `
                            <button onclick="exitEditMode()" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-all">
                                Exit Edit Mode
                            </button>
                        `}
                    </div>
                </header>

                <div class="max-w-7xl mx-auto px-4 py-8">
                    <!-- Profile -->
                    <div class="bg-white rounded-2xl shadow-xl p-8 mb-8 relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full -mr-32 -mt-32 opacity-50"></div>
                        
                        <div class="relative flex flex-col md:flex-row gap-6 items-start">
                            <div class="text-6xl">üë§</div>
                            
                            <div class="flex-1">
                                ${state.isEditMode ? `
                                    <input class="text-3xl font-bold mb-2 w-full border-b-2 border-blue-300 focus:border-blue-500 outline-none bg-transparent" value="${state.profile.name}" onchange="updateProfile('name', this.value)" />
                                    <input class="text-xl text-gray-600 mb-4 w-full border-b border-gray-300 focus:border-blue-500 outline-none bg-transparent" value="${state.profile.title}" onchange="updateProfile('title', this.value)" />
                                    <textarea class="text-gray-700 leading-relaxed mb-4 w-full border rounded-lg p-2 focus:border-blue-500 outline-none" rows="3" onchange="updateProfile('bio', this.value)">${state.profile.bio}</textarea>
                                ` : `
                                    <h2 class="text-3xl font-bold mb-2 text-gray-800">${state.profile.name}</h2>
                                    <p class="text-xl text-gray-600 mb-4">${state.profile.title}</p>
                                    <p class="text-gray-700 leading-relaxed mb-4">${state.profile.bio}</p>
                                `}
                                
                                <div class="grid md:grid-cols-3 gap-3">
                                    <div class="flex items-center gap-2 text-gray-600">
                                        <span>üìß</span>
                                        ${state.isEditMode ? `<input class="text-sm flex-1 border-b border-gray-300 focus:border-blue-500 outline-none bg-transparent" value="${state.profile.email}" onchange="updateProfile('email', this.value)" />` : `<span class="text-sm">${state.profile.email}</span>`}
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-600">
                                        <span>üì±</span>
                                        ${state.isEditMode ? `<input class="text-sm flex-1 border-b border-gray-300 focus:border-blue-500 outline-none bg-transparent" value="${state.profile.phone}" onchange="updateProfile('phone', this.value)" />` : `<span class="text-sm">${state.profile.phone}</span>`}
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-600">
                                        <span>üìç</span>
                                        ${state.isEditMode ? `<input class="text-sm flex-1 border-b border-gray-300 focus:border-blue-500 outline-none bg-transparent" value="${state.profile.location}" onchange="updateProfile('location', this.value)" />` : `<span class="text-sm">${state.profile.location}</span>`}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Search -->
                    <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                        <div class="flex flex-col md:flex-row gap-4 items-center">
                            <input type="text" placeholder="üîç Search documents..." class="flex-1 px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" value="${state.searchTerm}" oninput="updateSearch(this.value)" />
                            ${state.isEditMode ? `<button onclick="openAddModal()" class="px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:shadow-lg transition-all whitespace-nowrap">+ Add Document</button>` : ''}
                        </div>

                        <div class="flex gap-2 mt-4 overflow-x-auto pb-2">
                            ${['all', 'achievements', 'certificates', 'resume', 'research'].map(cat => `
                                <button onclick="selectCategory('${cat}')" class="px-4 py-2 rounded-lg whitespace-nowrap transition-all ${state.selectedCategory === cat ? 'bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}">
                                    ${cat === 'all' ? 'üìÅ' : cat === 'achievements' ? 'üèÜ' : cat === 'certificates' ? 'üéì' : cat === 'resume' ? 'üíº' : 'üî¨'} ${cat.charAt(0).toUpperCase() + cat.slice(1)}
                                </button>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Documents -->
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        ${filteredDocs.map(doc => `
                            <div class="bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden">
                                <div class="h-2 bg-gradient-to-r ${doc.category === 'achievements' ? 'from-yellow-400 to-orange-400' : doc.category === 'certificates' ? 'from-green-400 to-teal-400' : doc.category === 'resume' ? 'from-blue-400 to-indigo-400' : 'from-purple-400 to-pink-400'}"></div>
                                
                                <div class="p-6">
                                    <h3 class="text-lg font-bold text-gray-800 mb-3">${doc.title}</h3>
                                    <p class="text-sm text-gray-600 mb-4 line-clamp-2">${doc.description || ''}</p>
                                    
                                    <div class="flex gap-2">
                                        <button onclick="viewDoc(${doc.id})" class="flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all">
                                            üëÅÔ∏è View
                                        </button>
                                        ${state.isEditMode ? `
                                            <button onclick="editDoc(${doc.id})" class="px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-all">‚úèÔ∏è</button>
                                            <button onclick="deleteDoc(${doc.id})" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-all">üóëÔ∏è</button>
                                        ` : ''}
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    ${filteredDocs.length === 0 ? `<div class="text-center py-16 bg-white rounded-2xl shadow-lg"><p class="text-gray-500 text-lg">üìÑ No documents found</p></div>` : ''}
                </div>

                <!-- Login Modal -->
                ${state.showLogin ? `
                    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div class="bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl animate-fade-in">
                            <h2 class="text-2xl font-bold mb-6 text-gray-800">üîí Admin Login</h2>
                            <input type="password" placeholder="Enter password" class="w-full px-4 py-3 border border-gray-300 rounded-lg mb-4 focus:ring-2 focus:ring-blue-500 outline-none" value="${state.password}" oninput="updatePassword(this.value)" onkeypress="if(event.key==='Enter') login()" />
                            <div class="flex gap-3">
                                <button onclick="login()" class="flex-1 px-4 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:shadow-lg transition-all">Login</button>
                                <button onclick="closeLogin()" class="px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all">Cancel</button>
                            </div>
                            <p class="text-xs text-gray-500 mt-4 text-center">Password: admin123</p>
                        </div>
                    </div>
                ` : ''}

                <!-- Upload Modal -->
                ${state.showUploadModal ? `
                    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto">
                        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full shadow-2xl my-8 animate-fade-in">
                            <h2 class="text-2xl font-bold mb-6">${state.editingDoc ? 'Edit Document' : 'Add Document'}</h2>
                            
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-semibold mb-2">Title *</label>
                                    <input value="${state.formData.title}" oninput="updateFormData('title', this.value)" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" />
                                </div>

                                <div>
                                    <label class="block text-sm font-semibold mb-2">Category *</label>
                                    <select onchange="updateFormData('category', this.value)" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
                                        <option value="achievements" ${state.formData.category === 'achievements' ? 'selected' : ''}>Achievements</option>
                                        <option value="certificates" ${state.formData.category === 'certificates' ? 'selected' : ''}>Certificates</option>
                                        <option value="resume" ${state.formData.category === 'resume' ? 'selected' : ''}>Resume</option>
                                        <option value="research" ${state.formData.category === 'research' ? 'selected' : ''}>Research</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-sm font-semibold mb-2">Description</label>
                                    <input value="${state.formData.description}" oninput="updateFormData('description', this.value)" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" />
                                </div>

                                <div>
                                    <label class="block text-sm font-semibold mb-2">Upload File (PDF or Text)</label>
                                    <input type="file" accept=".pdf,.txt,.doc,.docx" onchange="handleFileChange(event)" class="w-full px-4 py-3 border rounded-lg" />
                                    <p class="text-xs text-gray-500 mt-1">Or write content below</p>
                                </div>

                                <div>
                                    <label class="block text-sm font-semibold mb-2">Content *</label>
                                    <textarea rows="10" oninput="updateFormData('content', this.value)" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none font-mono text-sm">${state.formData.content}</textarea>
                                </div>

                                <div class="flex gap-3 pt-4">
                                    <button onclick="saveDocument()" class="flex-1 px-4 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:shadow-lg transition-all">üíæ Save</button>
                                    <button onclick="closeUploadModal()" class="px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                ` : ''}

                <!-- Viewer Modal -->
                ${state.showViewerModal && state.currentDoc ? `
                    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] flex flex-col shadow-2xl animate-fade-in">
                            <div class="bg-gradient-to-r from-blue-500 to-purple-500 text-white p-6 rounded-t-2xl flex justify-between items-center">
                                <h3 class="text-xl font-bold">${state.currentDoc.title}</h3>
                                <button onclick="closeViewer()" class="p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-all">‚úñÔ∏è</button>
                            </div>
                            
                            <div class="p-8 overflow-y-auto flex-1">
                                ${state.currentDoc.fileType === 'pdf' ? `
                                    <iframe src="${state.currentDoc.content}" class="w-full h-full min-h-[600px] rounded-lg border-2" title="${state.currentDoc.title}"></iframe>
                                ` : `
                                    <pre class="whitespace-pre-wrap font-sans text-gray-700 leading-relaxed">${state.currentDoc.content}</pre>
                                `}
                            </div>
                        </div>
                    </div>
                ` : ''}
            `;
        }

        // Initialize
        window.onload = loadData;
    </script>
</body>
</html>
